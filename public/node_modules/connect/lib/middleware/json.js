function noop(e,t,n){n()}var utils=require("../utils"),_limit=require("./limit");exports=module.exports=function(e){var e=e||{},t=e.strict===!1?!1:!0,n=e.limit?_limit(e.limit):noop;return function(r,i,o){return r._body?o():(r.body=r.body||{},"application/json"!=utils.mime(r)?o():(r._body=!0,n(r,i,function(n){if(n)return o(n);var i="";r.setEncoding("utf8"),r.on("data",function(e){i+=e}),r.on("end",function(){if(t&&"{"!=i[0]&&"["!=i[0])return o(utils.error(400,"invalid json"));try{r.body=JSON.parse(i,e.reviver),o()}catch(n){n.body=i,n.status=400,o(n)}})}),void 0))}};