function defaultValue(e){return e.body&&e.body._csrf||e.query&&e.query._csrf||e.headers["x-csrf-token"]}var utils=require("../utils");module.exports=function(e){var e=e||{},t=e.value||defaultValue;return function(e,n,r){var i=e.session._csrf||(e.session._csrf=utils.uid(24));if("GET"==e.method||"HEAD"==e.method||"OPTIONS"==e.method)return r();var o=t(e);return o!=i?r(utils.error(403)):(r(),void 0)}};